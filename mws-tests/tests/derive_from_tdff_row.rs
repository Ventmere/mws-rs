#[macro_use]
extern crate mws_derive;
extern crate mws;

#[test]
fn derive_struct() {
  use mws::tdff::TdffParser;
  use std::io::Cursor;
  #[derive(Default, FromTdffRow)]
  struct S {
    #[from_tdff_row(key = "sku,seller_sku")]
    sku_: String,
    asin: String,
    price: String,
    quantity: i32,
  }

  impl S {
    fn as_tuple(&self) -> (&str, &str, &str, i32) {
      (&self.sku_, &self.asin, &self.price, self.quantity)
    }
  }
  let bytes: Vec<u8> = include_bytes!("./fixtures/report.tdff")
    .into_iter()
    .cloned()
    .collect();
  let r = Cursor::new(bytes);
  let rows = TdffParser::new(r).unwrap().parse_all::<S>().unwrap();
  let tuples: Vec<_> = rows.iter().map(S::as_tuple).collect();

  assert_eq!(
    tuples,
    vec![
      ("OQ-5B1U-8LAN", "B004EOOAXQ", "624.99", 57),
      ("edifier-760d", "B00PMDYEHK", "1124.99", 19),
      ("edifier-b3", "B01CCBHNVS", "279.99", 224),
      ("edifier-bte10", "B00NTQIIAQ", "162.99", 156),
      ("edifier-e10", "B009XGH2HG", "124.99", 211),
      ("edifier-e10-fba", "B009XGH2HG", "99.99", 0),
      ("edifier-e235-red", "B075RD1FNH", "649.99", 192),
      ("edifier-e25-black", "B00LWW51UO", "249.99", 166),
      ("edifier-e25-red", "B00LWW5HT4", "249.99", 130),
      ("edifier-e25-stand-black", "B00WBTQHG4", "124.99", 16),
      ("edifier-e25-stand-red", "B00WBTQHPU", "124.99", 111),
      ("edifier-e25-white", "B00LWW5ONI", "249.99", 148),
      ("edifier-e255-red", "B01CDJM6NO", "1399.99", 41),
      ("edifier-e25b", "B00GDDTTFA", "249.99", 363),
      ("edifier-e25hd-black", "B00WKIY74U", "312.99", 288),
      ("edifier-e25hd-red", "B00WKIY6KK", "312.99", 339),
      ("edifier-e25hd-white", "B00WKIY6C8", "312.99", 201),
      ("edifier-e25r", "B00GBO3YK2", "249.99", 306),
      ("edifier-e25w", "B00GINTZBI", "249.99", 278),
      ("edifier-e30b", "B008BSII2A", "349.95", 22),
      ("edifier-e30r", "B008BSII66", "349.95", 38),
      ("edifier-e3350btb", "B0083RSSWO", "162.99", 41),
      ("edifier-e3350btbg", "B008NP3K1K", "162.99", 23),
      ("edifier-e3350btblu", "B008NP3KTW", "162.99", 0),
      ("edifier-e3350bts", "B0083RSSZQ", "162.99", 5),
      ("edifier-e3360-Black", "B00NTQOT9U", "185.95", 297),
      ("edifier-e3360-White", "B00NTQOUCG", "185.95", 193),
      ("edifier-g2-white", "B00SR6D3D0", "49.99", 0),
      ("edifier-h180-black", "B016AY6CB0", "16.24", 0),
      ("edifier-h180-white", "B016AY6DQO", "16.24", 0),
      ("edifier-h185-blue", "B01C7XBAFQ", "18.63", 0),
      ("edifier-h185-gold", "B00GOMNRF8", "18.63", 0),
      ("edifier-h185-green", "B01C7XBC0Y", "18.63", 0),
      ("edifier-h190-black", "B01C7XBDMG", "23.75", 0),
      ("edifier-h190-white", "B01C7XBGKA", "23.75", 0),
      ("edifier-h290-white", "B00CGVH478", "35.99", 0),
      ("edifier-h650-black-usa", "B013ILR8ZC", "36.04", 0),
      ("edifier-h650-blue", "B013ILTSGY", "36.04", 0),
      ("edifier-h650-orange", "B013IM78TW", "36.04", 0),
      ("edifier-h650-pink", "B013ILWJR4", "36.04", 0),
      ("edifier-h650-purple", "B013ILZGKQ", "36.04", 0),
      ("edifier-h650-white", "B013IKWU7Y", "36.04", 0),
      ("edifier-h690", "B00IZ1TU4S", "79.99", 0),
      ("edifier-h750-red", "B00GQNI8OU", "39.99", 0),
      ("edifier-h750-white", "B00GQNI8LS", "39.99", 0),
      ("edifier-h840-black-usa", "B013J7WUGC", "49.99", 0),
      ("edifier-h840-blue", "B013J8CB2E", "49.99", 0),
      ("edifier-h850", "B013J8DROA", "69.99", 0),
      ("edifier-h880-black", "B075KM4R7J", "179.99", 0),
      ("edifier-k180-black", "B01J7K0VC0", "19.99", 0),
      ("edifier-k180-white", "B01J7K0VE8", "19.99", 0),
      ("edifier-k210-black", "B009FR0OIC", "19.99", 0),
      ("edifier-k210-white", "B009FR0PEU", "19.99", 0),
      ("edifier-k680-red", "B009FR0RV6", "19.99", 0),
      ("edifier-k800-blue", "B01MU3DWO3", "19.99", 0),
      ("edifier-k800-cam", "B00S2MDOYC", "19.99", 0),
      ("edifier-k815-black-ca", "B013JG34HC", "39.99", 0),
      ("edifier-k815-white", "B013JG71CG", "39.99", 0),
      ("edifier-k830-black", "B00L73N902", "39.99", 0),
      ("edifier-k830-white", "B00S2MENVU", "39.99", 0),
      ("edifier-m1380-ca1", "B004N31D9W", "74.99", 359),
      ("edifier-m1380-ca2", "B017AJIIC0", "74.99", 50),
      ("edifier-m3200", "B00646KQOY", "94.99", 355),
      ("edifier-m3600d", "B07BLZVT6D", "199.99", 443),
      ("edifier-m710-red", "B01CDXSDS2", "45.99", 0),
      ("edifier-m710-white", "B01CDXUNAS", "45.99", 0),
      ("edifier-mf240-black", "B00646KR6G", "99.99", 50),
      ("edifier-mf240bt-white", "B00646KRAM", "99.99", 50),
      ("edifier-mp100-blue", "B073RLP9R4", "35.99", 0),
      ("edifier-mp100-green", "B073RM6Y6W", "35.99", 0),
      ("edifier-mp100-yellow", "B073RM3C27", "35.99", 0),
      ("edifier-mp200-black", "B0744ZV3P1", "45.99", 0),
      ("edifier-mp200-blue", "B07452KYQZ", "44.99", 0),
      ("edifier-mp200-green", "B0744XV7B5", "44.99", 0),
      ("edifier-mp200-ltblue", "B0744ZP2BV", "44.99", 0),
      ("edifier-mp200-ltgreen", "B07454K789", "44.99", 0),
      ("edifier-mp200-white", "B07456XBXM", "44.99", 0),
      ("edifier-mp200-yellow", "B0744ZP2BS", "45.99", 0),
      ("edifier-mp270-black", "B074PFVMD7", "79.99", 0),
      ("edifier-mp270-blue", "B074PFGH9D", "79.99", 0),
      ("edifier-mp270-red", "B074PFS2QN", "79.99", 0),
      ("edifier-mp280-black", "B01BHXOAKO", "79.99", 0),
      ("edifier-mp280-blue", "B01BHXO8I8", "79.99", 0),
      ("edifier-mp280-red", "B01BHXOBP8", "79.99", 0),
      ("edifier-mp700-fbm", "B016QULIMQ", "239.99", 83),
      ("edifier-p180-black", "B013J1KH2M", "22.23", 0),
      ("edifier-p180-white", "B013J2LC2A", "22.23", 0),
      ("edifier-p185-blue", "B01C7XBEFC", "23.75", 0),
      ("edifier-p185-grey", "B01C7XBGXW", "23.75", 0),
      ("edifier-p185-red", "B01C7XBFU6", "23.75", 0),
      ("edifier-p190-black", "B01C7XBI1C", "31.13", 0),
      ("edifier-p190-white", "B01C7XBJCU", "31.13", 0),
      ("edifier-p265", "B01N9XDVWO", "34.99", 0),
      ("edifier-p270-gold", "B013J7O3ZI", "33.99", 0),
      ("edifier-p270-silver", "B013J7M8UK", "33.99", 0),
      ("edifier-p275-red", "B01C7YFGUA", "34.38", 0),
      ("edifier-p281-red", "B01MCWSVOT", "49.99", 0),
      ("edifier-p281-silver", "B075LH51H2", "49.99", 0),
      ("edifier-p281-white", "B01M676XLY", "49.99", 0),
      ("edifier-p293-green", "B013J7BP3G", "44.99", 0),
      ("edifier-p293-white", "B013J78B4W", "44.99", 0),
      ("edifier-p640-white", "B01C7XBNVM", "42.38", 0),
      ("edifier-p690", "B01NGYV80E", "99.99", 0),
      ("edifier-p750-black", "B01C7XBBQE", "44.99", 0),
      ("edifier-p750-red", "B01C7XBDAI", "44.99", 0),
      ("edifier-p750-white", "B01C7XBA7Y", "44.99", 0),
      ("edifier-p841-black", "B01J7K0OYU", "59.99", 0),
      ("edifier-p841-white", "B01J7K0OXG", "59.99", 0),
      ("edifier-r1010bt-black", "B071YV97LK", "124.99", 0),
      ("edifier-r1280db-black", "B06XGG6MFV", "162.49", 0),
      ("edifier-r1280db-wood", "B0719C132V", "162.49", 0),
      ("edifier-r1280t-fba", "B016P9HJIA", "124.99", 0),
      ("edifier-r1700bt-fba", "B016PATXSI", "179.99", 0),
      ("edifier-r1850db-black", "B073W1R4XQ", "249.99", 0),
      ("edifier-r19u", "B00VQSKCW6", "37.99", 8),
      ("edifier-r19u-2017", "B075VBXGT2", "39.99", 0),
      ("edifier-r2000db-black", "B016PAWJYS", "299.99", 0),
      ("edifier-r2000wood-fba", "B01CDU3IAI", "299.99", 0),
      ("edifier-r980t-fba", "B01LXDZ8WB", "89.99", 0),
      ("edifier-s1000db", "B01CDIS6M0", "489.99", 453),
      ("edifier-s1000db-fba", "B01CDIS6M0", "489.99", 0),
      ("edifier-s2000pro-stand", "B07814L8GQ", "194.99", 64),
      ("edifier-s2000pro-wood", "B0725GZQFZ", "499.99", 0),
      ("edifier-s2000pro-wood-fbm", "B0725GZQFZ", "499.99", 657),
      ("edifier-s330d-usa", "B002BA5JLW", "249.99", 85),
      ("edifier-s350db", "B077Y6PHKQ", "389.99", 574),
      ("edifier-s350db-fba", "B077Y6PHKQ", "389.99", 0),
      ("edifier-s50db", "B07FPGRQT8", "389.99", 44),
      ("edifier-s730", "B00801Q0QO", "624.99", 26),
      ("edifier-s880db", "B07D41XN1F", "374.99", 0),
      ("edifier-s880db-fbm", "B07D41XN1F", "374.99", 276),
      ("edifier-w23bt-black", "B01N5CKYIT", "29.99", 0),
      ("edifier-w23bt-gold", "B01N0O0SRB", "29.99", 0),
      ("edifier-w23bt-red", "B01N9ESJXE", "29.99", 0),
      ("edifier-w23bt-silver", "B01N7FFGF4", "29.99", 0),
      ("edifier-w280bt-black", "B074XGHQ6P", "49.99", 0),
      ("edifier-w280bt-blue", "B074X8Q969", "49.99", 0),
      ("edifier-w280bt-red", "B074XDBLDC", "49.99", 0),
      ("edifier-w280bt-white", "B074XBF8N2", "49.99", 0),
      ("edifier-w288bt-red", "B01NAFY4PD", "79.99", 0),
      ("edifier-w288bt-white", "B01N9EC54X", "79.99", 0),
      ("edifier-w288bt-yellow", "B01N6DKO6N", "79.99", 0),
      ("edifier-w293bt-black", "B0759V9W3W", "59.99", 0),
      ("edifier-w293bt-bright-silver", "B0759ZL4PV", "59.99", 0),
      ("edifier-w293bt-silver", "B0759P95WK", "59.99", 0),
      ("edifier-w296bt-black", "B0759VFYH2", "74.99", 0),
      ("edifier-w296bt-red", "B0759QSWVS", "74.99", 0),
      ("edifier-w296bt-white", "B0759RNDVK", "74.99", 0),
      ("edifier-w360bt-black", "B0751MN7SL", "74.99", 0),
      ("edifier-w360bt-white", "B0751JZLVH", "74.99", 0),
      ("edifier-w570bt-black", "B01J7K0VCU", "59.99", 0),
      ("edifier-w800bt-black", "B0746MNLVV", "59.99", 0),
      ("edifier-w800bt-red1", "B0746LYPXM", "59.99", 0),
      ("edifier-w800bt-white1", "B0746MM2S1", "59.99", 0),
      ("edifier-w830bt-fbm", "B07533GCYK", "99.99", 33),
      ("edifier-w855bt-brown", "B01NAYUQTK", "179.99", 0),
      ("Edifier-w670bt-black", "B00RE0YYS8", "69.99", 0),
      ("PN-ZZYU-RIIR", "B009FR0SQU", "19.99", 0),
      ("edifier-c2xd", "B00A50PFIW", "249.99", 0),
      ("edifier-e10bt-fba", "B00NTQIIAQ", "162.99", 0),
      ("edifier-e25-stand-white", "B00WBTQHW8", "124.99", 0),
      ("edifier-e3350btw", "B0083RSST2", "162.99", 0),
      ("edifier-g10-camo", "B0747YZRN2", "35.99", 0),
      ("edifier-g2-black", "B013KBNL88", "49.99", 0),
      ("edifier-g20-black", "B0747ZNYGG", "59.99", 0),
      ("edifier-g3", "B00UAFQAW2", "99.99", 0),
      ("edifier-g4-green", "B0744ZT4VZ", "129.99", 0),
      ("edifier-g4-red", "B07454X2XM", "129.99", 0),
      ("edifier-g4-white", "B07454298K", "129.99", 0),
      ("edifier-h190-gold", "B01C7XBEZ2", "23.75", 0),
      ("edifier-h210-black", "B00JKNNWPI", "13.74", 0),
      ("edifier-h210-blue", "B013IIIPMK", "13.74", 0),
      ("edifier-h210-red", "B013IIKTJW", "13.74", 0),
      ("edifier-h210-white", "B013IICZ9Y", "13.74", 0),
      ("edifier-h220-black", "B01C7XBHVI", "22.38", 0),
      ("edifier-h220-white", "B01C7XBJA2", "22.38", 0),
      ("edifier-h280-black", "B00T40VS5I", "19.99", 0),
      ("edifier-h280-blue", "B00T95XUSQ", "19.99", 0),
      ("edifier-h280-grey", "B008SM1KMY", "19.99", 0),
      ("edifier-h280-pink", "B00T40VRW2", "19.99", 0),
      ("edifier-h285-black", "B0093HNAJ4", "19.99", 0),
      ("edifier-h285-white", "B0093HNCC4", "19.99", 0),
      ("edifier-h290-black", "B00CGVH3AG", "35.99", 0),
      ("edifier-h297", "B01M2YW7UC", "129.99", 0),
      ("edifier-i285-black", "B013JEXZ8C", "39.99", 0),
      ("edifier-i285-white", "B013JF33DI", "39.99", 0),
      ("edifier-k550-black", "B0083DPGQ4", "19.99", 0),
      ("edifier-k550-black-usa", "B01J7K0RZ6", "12.99", 0),
      ("edifier-k550-red", "B0083DPHO0", "19.99", 0),
      ("edifier-k550-white", "B0083DPI2G", "19.99", 0),
      ("edifier-k680-black", "B009FR0QE4", "19.99", 0),
      ("edifier-k680-white", "B009FR0R7A", "19.99", 0),
      ("edifier-k680-yellow", "B009FR0SQU", "19.99", 0),
      ("edifier-k800", "B00S1IRR6S", "19.99", 0),
      ("edifier-m710-black", "B01CDXDSXC", "45.99", 0),
      ("edifier-m815-black", "B01CDXPNRQ", "45.99", 0),
      ("edifier-m815-white", "B01CDXXCLK", "45.99", 0),
      ("edifier-mp260-black", "B00D2LR8HM", "99.99", 0),
      ("edifier-mp260-blue", "B00D2LR76E", "99.99", 0),
      ("edifier-mp260-grey", "B00D2LR8H2", "99.99", 0),
      ("edifier-mp260-red", "B00D2LR8KO", "99.99", 0),
      ("edifier-mp260-yellow", "B00D2LR8N6", "99.99", 0),
      ("edifier-mp300blu", "B0052PVU5C", "124.99", 0),
      ("edifier-mp300p", "B0052PV4JO", "99.99", 0),
      ("edifier-mp300r", "B0052Q5WXW", "124.99", 0),
      ("edifier-mp700", "B016QULIMQ", "289.99", 0),
      ("edifier-p12-brown", "B07DM7F15C", "129.99", 0),
      ("edifier-p186-beige", "B01MSWB3OT", "19.99", 0),
      ("edifier-p186-black", "B01N2R3RBM", "19.99", 0),
      ("edifier-p186-blue", "B01MTXU4UF", "19.99", 0),
      ("edifier-p186-grey", "B01MQT93AI", "19.99", 0),
      ("edifier-p210-black", "B016LC8NVI", "19.99", 0),
      ("edifier-p210-blue", "B016LC8NW2", "19.99", 0),
      ("edifier-p210-red", "B016LC8NT0", "19.99", 0),
      ("edifier-p210-white", "B016LC8NUE", "19.99", 0),
      ("edifier-p220-black", "B01C7XBKDI", "28.63", 0),
      ("edifier-p220-blue", "B01C7XBMJ0", "28.63", 0),
      ("edifier-p220-white", "B01C7XBLHI", "28.63", 0),
      ("edifier-p270-black", "B013J7JZQK", "33.99", 0),
      ("edifier-p275-black", "B01AVD2G70", "34.38", 0),
      ("edifier-p275-blue", "B01C7YFI3A", "34.38", 0),
      ("edifier-p275-white", "B01C7YFJG6", "34.38", 0),
      ("edifier-p640-black", "B01C7XBP4C", "42.38", 0),
      ("edifier-p640-yellow", "B01C7XB8LM", "42.38", 0),
      ("edifier-r1010bt-wood", "B0711CTY1F", "124.99", 0),
      ("edifier-r1280db-black-fbm", "B06XGG6MFV", "162.49", 0),
      ("edifier-r1280db-wood-fbm", "B0719C132V", "162.49", 0),
      ("edifier-r1280t-ca", "B016P9HJIA", "124.99", 0),
      ("edifier-r1700bt", "B016PATXSI", "179.99", 0),
      ("edifier-r1850db-black-fbm", "B073W1R4XQ", "249.99", 0),
      ("edifier-r19u-fba", "B00VQSKCW6", "37.99", 0),
      ("edifier-r2000wood", "B01CDU3IAI", "299.99", 0),
      ("edifier-r980t-fbm", "B01LXDZ8WB", "79.99", 0),
      ("edifier-s550", "B00PA48FTE", "749.99", 0),
      ("edifier-ss02-wood", "B07814L8GQ", "194.99", 0),
      ("edifier-w288bt-black", "B01N7EYZ35", "79.99", 0),
      ("edifier-w295bt-black", "B06XHSS7Y3", "99.99", 0),
      ("edifier-w295bt-red", "B06XHTP5GB", "99.99", 0),
      ("edifier-w570bt-white", "B01J7K0VHU", "59.99", 0),
      ("edifier-w670bt-white", "B00SR64LCM", "69.99", 0),
      ("edifier-w830bt", "B07533GCYK", "129.99", 0),
      ("edifier-w855bt-black", "B01N4TZEEB", "179.99", 0),
      ("edifier-w860nb", "B07DVR2TS1", "199.00", 0),
    ]
  )
}
